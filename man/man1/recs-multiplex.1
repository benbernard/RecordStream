.TH RECS\-MULTIPLEX 1 "2026-02-22" "recs 0.1.0" "RecordStream Manual"

.SH NAME
recs\-multiplex \- Take records, grouped together by \-\-keys, and run a separate operation instance for each group

.SH SYNOPSIS
.B recs multiplex [options] -- <other recs operation>

.SH DESCRIPTION
Take records, grouped together by \-\-keys, and run a separate operation instance for each group. Each group gets its own operation instance.
.PP

.SH OPTIONS
.TP
\fB--key\fR, \fB-k\fR \fI<keys>\fR
Comma\-separated list of key fields for grouping. May be a key spec or key group.
.TP
\fB--dlkey\fR, \fB-K\fR \fI<name>=<expression>\fR
Domain language key: name=expression where the expression evaluates as a valuation.
.TP
\fB--line-key\fR, \fB-L\fR \fI<key>\fR
Use the value of this key as line input for the nested operation (rather than the entire record). Use with recs from* operations generally.
.TP
\fB--output-file-key\fR, \fB-o\fR \fI<key>\fR
Write each group\'s output to a separate file, using the value of the given key as the filename.
.TP
\fB--output-file-eval\fR, \fB-O\fR \fI<expression>\fR
Write each group\'s output to a separate file, with filename determined by the given expression. Supports {{key}} interpolation with group key values.
.TP
\fB--adjacent\fR, \fB-1\fR
Only group together adjacent records. Avoids spooling records into memory.
.TP
\fB--size\fR, \fB--sz\fR, \fB-n\fR \fI<number>\fR
Number of running clumps to keep.
.TP
\fB--cube\fR
Enable cube mode.
.TP
\fB--clumper\fR, \fB-c\fR \fI<spec>\fR
Clumper specification (e.g. keylru,field,size or keyperfect,field).
.TP
\fB--dlclumper\fR \fI<expression>\fR
Domain language clumper specification.
.TP
\fB--list-clumpers\fR
List available clumpers and exit.
.TP
\fB--show-clumper\fR \fI<name>\fR
Show details of a specific clumper and exit.

.SH EXAMPLES
Tag lines with counts by thread
.PP
.RS 4
.nf
\fBrecs multiplex -k thread -- recs eval \'r.nbr = ++nbr\'\fR
.fi
.RE

Separate out a stream of text by PID into separate invocations of an operation
.PP
.RS 4
.nf
\fBrecs fromre \'^(.*PID=([0-9]*).*)$\' -f line,pid | recs multiplex -L line -k pid -- recs frommultire ...\fR
.fi
.RE

Write each group\'s CSV output to separate files by department
.PP
.RS 4
.nf
\fBrecs multiplex -k department -O \'output-{{department}}.csv\' -- recs tocsv\fR
.fi
.RE

.SH SEE ALSO
\fBrecs\-collate\fR(1), \fBrecs\-chain\fR(1)

.SH AUTHOR
Benjamin Bernard <perlhacker@benjaminbernard.com>

