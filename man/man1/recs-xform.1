.TH RECS\-XFORM 1 "2026-02-24" "recs 0.1.0" "RecordStream Manual"

.SH NAME
recs\-xform \- Transform records with a JS snippet

.SH SYNOPSIS
.B recs xform [options] <expression> [files...]

.SH DESCRIPTION
Transform records with a JS snippet. The expression is evaluated on each record with r set to the current Record object. If the expression returns an array, each element becomes a separate output record. Otherwise the (possibly mutated) record is output. You can also use push_output and push_input to control record flow.
.PP

.SH OPTIONS
.TP
\fB--before\fR, \fB-B\fR \fI<NUM>\fR
Make NUM records before this one available in the B array.
.TP
\fB--after\fR, \fB-A\fR \fI<NUM>\fR
Make NUM records after this one available in the A array.
.TP
\fB--context\fR, \fB-C\fR \fI<NUM>\fR
Make NUM records available in both the A and B arrays (equivalent to \-A NUM \-B NUM).
.TP
\fB--post-snippet\fR \fI<snippet>\fR
A snippet to run once the stream has completed.
.TP
\fB--pre-snippet\fR \fI<snippet>\fR
A snippet to run before the stream starts.

.SH EXAMPLES
Add line number to records
.PP
.RS 4
.nf
\fBrecs xform \'r.line = line\'\fR
.fi
.RE

Rename field old to new and remove field a
.PP
.RS 4
.nf
\fBrecs xform \'r.rename("old", "new"); r.remove("a")\'\fR
.fi
.RE

Remove fields which are not a, b, or c
.PP
.RS 4
.nf
\fBrecs xform \'r.prune_to("a", "b", "c")\'\fR
.fi
.RE

Move a value from the previous record to the current record
.PP
.RS 4
.nf
\fBrecs xform -B 1 \'r.before_val = B[0]\'\fR
.fi
.RE

.SH SEE ALSO
\fBrecs\-grep\fR(1), \fBrecs\-annotate\fR(1), \fBrecs\-eval\fR(1)

.SH AUTHOR
Benjamin Bernard <perlhacker@benjaminbernard.com>

